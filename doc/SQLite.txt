BLOB | INTEGER | INT | REAL | CHAR(50) | VARCHAR | TEXT
--
vacuum;
--
ATTACH DATABASE 'I:\NPSoft_BET-DAFANBA\db\dbBet_17032x.db3' AS aux_17032x;
DETACH DATABASE aux_17032x;
--
SELECT * FROM sqlite_master;
--
pragma table_info(AGIN);
--
CREATE TABLE AGIN(
	Id BIGINT PRIMARY KEY NOT NULL,
	CoordinateX INT NULL,
	CoordinateY INT NULL,
	FileNames NVARCHAR(2147483647) NULL,
	DataAnalysis NVARCHAR(2147483647) NULL,
	CreatedOn DATETIME NULL,
	CreatedBy BIGINT NULL,
	LastModifiedOn DATETIME NULL,
	LastModifiedBy BIGINT NULL
);
CREATE TABLE AGIN_TRACK(
    Id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    CoordinateX INT NULL,
    CoordinateY INT NULL,
    FileNames NVARCHAR(255) NULL,
    DataAnalysis NVARCHAR(2147483647) NULL,
    CreatedOn DATETIME NULL,
    CreatedBy BIGINT NULL,
    LastModifiedOn DATETIME NULL,
    LastModifiedBy BIGINT NULL
);
CREATE TABLE AGIN_SUMMARY(
	Id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
	CoordinateX INT NULL,
	CoordinateY INT NULL,
	FileNames NVARCHAR(2147483647) NULL,
	DataAnalysis NVARCHAR(2147483647) NULL,
	CreatedOn DATETIME NULL,
	CreatedBy BIGINT NULL,
	LastModifiedOn DATETIME NULL,
	LastModifiedBy BIGINT NULL
);
CREATE TABLE AGIN_RESULT1(
	Id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
	SubId INTEGER NULL,
	LatestOrder INT NULL,
	Type NVARCHAR(2147483647) NULL,
	Times INT NULL,
	Tags NVARCHAR(2147483647) NULL,
	FOREIGN KEY(SubId) REFERENCES AGIN_SUMMARY(Id)
);
CREATE TABLE AGIN_RESULT2(
	Id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
	SubId INTEGER NULL,
	LatestOrder INT NULL,
	NumCircleRed INT NULL,
	NumCircleBlue INT NULL,
	Matches NVARCHAR(2147483647) NULL,
	FOREIGN KEY(SubId) REFERENCES AGIN_SUMMARY(Id)
);
--
DROP TABLE AGIN;
--
ALTER TABLE AGIN RENAME TO AGIN_TRACK;
--
ALTER TABLE AGIN ADD Status VARCHAR NULL;
--
INSERT INTO AGIN (Id, CoordinateX, CoordinateY, FileNames, DataAnalysis, CreatedOn, CreatedBy, LastModifiedOn, LastModifiedBy)
VALUES (0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
INSERT INTO AGIN_SUMMARY (CoordinateX, CoordinateY, FileNames, DataAnalysis, CreatedOn, CreatedBy, LastModifiedOn, LastModifiedBy)
SELECT CoordinateX, CoordinateY, FileNames, DataAnalysis, CreatedOn, CreatedBy, LastModifiedOn, LastModifiedBy FROM aux.AGIN;
--
DELETE FROM AGIN;
--
PRAGMA foreign_keys=off;
BEGIN TRANSACTION;
ALTER TABLE AGIN_TRACK RENAME TO tmpAGIN_TRACK;
CREATE TABLE AGIN_TRACK(
    Id BIGINT PRIMARY KEY NOT NULL,
    CoordinateX INT NULL,
    CoordinateY INT NULL,
    FileNames NVARCHAR(255) NULL,
    DataAnalysis NVARCHAR(2147483647) NULL,
    CreatedOn DATETIME NULL,
    CreatedBy BIGINT NULL,
    LastModifiedOn DATETIME NULL,
    LastModifiedBy BIGINT NULL
);
INSERT INTO AGIN_TRACK(Id, CoordinateX, CoordinateY, FileNames, DataAnalysis, CreatedOn, CreatedBy, LastModifiedOn, LastModifiedBy)
SELECT Id, CoordinateX, CoordinateY, FileNames, DataAnalysis, CreatedOn, CreatedBy, LastModifiedOn, LastModifiedBy FROM tmpAGIN_TRACK;
DROP TABLE tmpAGIN_TRACK;
COMMIT;
PRAGMA foreign_keys=on;
--
BEGIN TRANSACTION;
WITH RECURSIVE fibo (curr, next)
AS (
    SELECT 1, 1
    UNION ALL
    SELECT next, curr + next FROM fibo LIMIT 10)
SELECT group_concat(CAST(curr AS NVARCHAR) || '-' || CAST(next AS NVARCHAR)) Result FROM fibo;
END TRANSACTION;
--
SELECT AT.*, strftime('%m/%d/%Y', substr(AT.CreatedOn, 0, 20)) FROM AGIN_TRACK AT ORDER BY AT.Id ASC LIMIT 0, 10;
SELECT last_insert_rowid();
